<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>啟動中 - 聖瑪智慧排床系統</title>
    <script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.js"></script>
</head>
<body>
    <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; font-family: sans-serif; color: #666;">
        <div class="loader"></div>
        <p>正在連線至聖瑪 FHIR 伺服器並驗證權限...</p>
    </div>

    <style>
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #764ba2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>

    <script>
        // 執行 SMART on FHIR 啟動程序
        FHIR.oauth2.authorize({
            // 這是你在 FHIR Server 上註冊的 Client ID
            // 若在測試環境（如 THAS Sandbox）通常可以自定義或使用預設值
            clientId: "st_mary_bed_manager_v2", 

            // 請求的權限範圍：
            // launch: 啟動上下文
            // openid / fhirUser: 使用者資訊
            // patient/*.read: 讀取病患資料
            // encounter.read: 讀取就醫紀錄（排床用）
            scope: "launch openid fhirUser patient/*.read encounter.read location.read",

            // 授權成功後跳轉回主程式頁面
            redirectUri: "index.html" 
        });
    </script>
</body>
</html>